endpoints:
  - name: "High CPU Usage Check"
    enabled: true
    group: "host"
    url: "http://prometheus.dms.dappnode:9090/api/v1/query?query=100*avg%20by%20(instance)%20(rate(node_cpu_seconds_total%7Bmode%21%3D%22idle%22%7D%5B2m%5D))"
    method: "GET"
    interval: "30s"
    conditions:
      - "[BODY].data.result[0].value[1] < 80"
    metric: 
      min: 0;
      max: 100;
      unit: "%"
    definition:
      title: "Configure your CPU Usage Alert"
      description: "Triggers if CPU usage exceeds the limit defined in the condition"
    alerts:
      - type: custom
        enabled: true
        description: "CPU % usage above [CONDITION_VALUE]"
        failure-threshold: 2
        success-threshold: 1
        send-on-resolved: true

  - name: "Host out of memory check"
    enabled: true
    group: "host"
    url: "http://prometheus.dms.dappnode:9090/api/v1/query?query=100*node_memory_MemAvailable_bytes%20%2F%20node_memory_MemTotal_bytes"
    method: "GET"
    interval: "30s"  
    conditions:
      - "[BODY].data.result[0].value[1] > 10" 
    metric: 
      min: 0;
      max: 100;
      unit: "%"
    definition:
      title: "Configure your Memory Usage Alert"
      description: "Triggers if available memory is below the limit defined in the condition"
    alerts:
      - type: custom
        enabled: true
        description: "Available memory below [CONDITION_VALUE]"
        failure-threshold: 2
        success-threshold: 1  
        send-on-resolved: true



